<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
    <title>üåç Guardianes del Planeta ¬∑ Misi√≥n Tierra Verde</title>
    <!-- Font Awesome 6 (Free) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- html2canvas para generar certificado -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Comic Sans MS', 'Segoe UI', sans-serif;
        }

        body {
            background: radial-gradient(circle at 10% 30%, #1b5e20, #0a3f0a);
            background-attachment: fixed;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* DECORACI√ìN DE HOJAS CAYENDO (CSS puro) */
        .leaf {
            position: fixed;
            top: -10vh;
            font-size: 2rem;
            opacity: 0.6;
            animation: fall linear infinite;
            pointer-events: none;
            z-index: 5;
        }
        @keyframes fall {
            to { transform: translateY(110vh) rotate(360deg); }
        }

        .container {
            max-width: 1300px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            border-radius: 60px 60px 40px 40px;
            padding: 30px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.4);
            border: 2px solid rgba(255,255,255,0.3);
            position: relative;
            z-index: 20;
        }

        /* HEADER CON NARRATIVA */
        .narrative-header {
            background: linear-gradient(145deg, #2e7d32, #1b5e20);
            border-radius: 40px 40px 20px 20px;
            padding: 30px 20px;
            color: white;
            text-align: center;
            border: 4px solid #ffee58;
            box-shadow: 0 10px 0 #b9f6ca;
            margin-bottom: 30px;
        }
        .narrative-header h1 {
            font-size: 3.5rem;
            text-shadow: 5px 5px 0 #00695c;
            letter-spacing: 4px;
        }
        .narrative-header p {
            font-size: 1.4rem;
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 50px;
            border-left: 8px solid #ffb74d;
        }

        /* TABLERO DE PUNTOS - M√ÅS VISUAL */
        .score-dashboard {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            border-radius: 30px;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-around;
            box-shadow: 0 10px 0 rgba(0,0,0,0.1);
            border: 4px solid #fdd835;
        }
        .stat-icon {
            font-size: 3rem;
        }
        .stat-info {
            text-align: right;
        }
        .stat-number {
            font-size: 2.8rem;
            font-weight: 900;
            color: #1e3c1e;
            line-height: 1;
        }
        .stat-label {
            font-size: 1rem;
            color: #37474f;
            font-weight: 600;
        }

        /* MISIONES con FEEDBACK m√°s rico */
        .missions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        .mission-card {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(4px);
            border-radius: 30px;
            padding: 0;
            transition: 0.4s;
            border: 5px solid #c8e6c9;
            box-shadow: 0 15px 0 #558b2f;
            position: relative;
        }
        .mission-card.completed {
            border-color: #ffd600;
            background: #fff9c4;
            box-shadow: 0 15px 0 #f57f17;
        }
        .mission-header {
            padding: 20px;
            border-radius: 25px 25px 0 0;
            background: #a5d6a5;
            color: #1e3c1e;
        }
        .mission-emoji {
            font-size: 3.5rem;
        }
        .mission-title {
            font-size: 1.8rem;
            font-weight: 800;
        }
        .mission-points {
            background: #ffb300;
            display: inline-block;
            padding: 8px 15px;
            border-radius: 30px;
            color: black;
            font-weight: bold;
            margin-top: 8px;
        }
        .mission-body {
            padding: 20px;
        }
        .feedback-area {
            background: #eeeeee;
            padding: 12px;
            border-radius: 20px;
            margin: 15px 0;
            font-size: 0.95rem;
            border-left: 8px solid #2e7d32;
        }
        .btn-mission {
            width: 100%;
            padding: 15px;
            border: none;
            background: linear-gradient(145deg, #2e7d32, #1b5e20);
            color: white;
            font-size: 1.4rem;
            font-weight: bold;
            border-radius: 20px;
            cursor: pointer;
            transition: 0.2s;
            border-bottom: 6px solid #0a3f0a;
        }
        .btn-mission:hover:not(:disabled) {
            transform: scale(0.97);
            background: #4caf50;
        }
        .btn-mission:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        /* FICHAS DE PERSONAJES - SUPER DETALLADAS */
        .characters-panel {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            margin: 50px 0;
        }
        .character-pro {
            background: linear-gradient(145deg, #fff3e0, #ffe0b2);
            border-radius: 40px 40px 20px 20px;
            padding: 0;
            border: 6px solid #ffcc80;
            box-shadow: 0 15px 0 #bf360c;
            transition: 0.3s;
        }
        .character-pro:hover {
            transform: translateY(-10px);
        }
        .character-avatar {
            background: #ffb74d;
            border-radius: 40px 40px 0 0;
            padding: 25px;
            font-size: 5rem;
            text-align: center;
        }
        .character-data {
            padding: 20px;
            background: white;
            border-radius: 0 0 30px 30px;
        }
        .character-name {
            font-size: 1.9rem;
            font-weight: 800;
        }
        .power-badge {
            background: #4fc3f7;
            padding: 8px;
            border-radius: 20px;
            color: #01579b;
            font-weight: bold;
            margin: 10px 0;
        }

        /* DATOS CURIOSOS con estilo */
        .facts-cool {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        .fact-item {
            background: #e1f5fe;
            padding: 25px;
            border-radius: 30px;
            border-right: 15px solid #0277bd;
            border-bottom: 15px solid #01579b;
        }

        /* MEDALLERO INTERACTIVO */
        .badge-collection {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            background: #fff8e1;
            padding: 30px;
            border-radius: 60px;
            margin: 40px 0;
        }
        .badge {
            background: #ffd54f;
            padding: 20px;
            border-radius: 50%;
            width: 120px;
            height: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 0 #ff6f00;
            color: #3e2723;
            font-weight: bold;
        }

        /* CERTIFICADO OCULTO (se genera al final) */
        .certificate-area {
            background: #fff9c4;
            border: 8px dashed #ffb300;
            padding: 30px;
            border-radius: 40px;
            text-align: center;
            margin: 30px 0;
        }

        /* MODAL DE GENIALLY (simulaci√≥n RED) */
        .genially-modal {
            background: #263238;
            padding: 25px;
            border-radius: 40px;
            color: white;
            margin: 30px 0;
            border: 6px solid #00acc1;
        }

        /* JUSTIFICACI√ìN PEDAG√ìGICA - visible */
        .pedagogy-section {
            background: #e8eaf6;
            padding: 30px;
            border-radius: 30px;
            border-left: 20px solid #3f51b5;
            margin-top: 40px;
        }

        @media (max-width: 800px) {
            .score-dashboard { grid-template-columns: 1fr 1fr; }
            .characters-panel { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- Hojas decorativas (CSS animado) -->
    <div class="leaf" style="left:5%; animation-duration:12s;">üçÉ</div>
    <div class="leaf" style="left:20%; animation-duration:18s;">üåø</div>
    <div class="leaf" style="left:50%; animation-duration:15s;">üçÇ</div>
    <div class="leaf" style="left:80%; animation-duration:20s;">üå±</div>
    <div class="leaf" style="left:95%; animation-duration:14s;">üçÄ</div>

    <div class="container">
        <!-- NARRATIVA DESTACADA - situamos al ni√±o como h√©roe -->
        <div class="narrative-header">
            <h1>üåç GUARDIANES DEL PLANETA</h1>
            <p style="font-size:2rem;">‚ú® Misi√≥n Tierra Verde ‚ú®</p>
            <p><i class="fas fa-quote-left"></i> Hola, peque√±o guardi√°n. La Capitana Verde, el Mago del Reciclaje y el Zorro Sabio te necesitan. ¬øAceptas el desaf√≠o de salvar el planeta con tus s√∫per poderes ecol√≥gicos? <i class="fas fa-quote-right"></i></p>
        </div>

        <!-- TABLERO DE PUNTOS MEJORADO -->
        <div class="score-dashboard">
            <div class="stat-card">
                <span class="stat-icon">‚≠ê</span>
                <div class="stat-info">
                    <div class="stat-number" id="levelDisplay">1</div>
                    <div class="stat-label">Nivel Guardi√°n</div>
                </div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">üèÜ</span>
                <div class="stat-info">
                    <div class="stat-number" id="pointsDisplay">0</div>
                    <div class="stat-label">Puntos Verdes</div>
                </div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">üéØ</span>
                <div class="stat-info">
                    <div class="stat-number" id="missionsCompleted">0</div>
                    <div class="stat-label">Misiones</div>
                </div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">‚è≥</span>
                <div class="stat-info">
                    <div class="stat-number" id="nextLevelHint">2</div>
                    <div class="stat-label">Pr√≥ximo nivel</div>
                </div>
            </div>
        </div>

        <!-- ========== MISIONES CON FEEDBACK Y PISTAS ========= -->
        <h2 style="color:white; font-size:2.5rem; text-shadow:4px 4px 0 #1e3c1e;"><i class="fas fa-tasks"></i> Misiones ecol√≥gicas</h2>
        <div id="missionsContainer" class="missions-grid"></div>

        <!-- ========== PERSONAJES (FICHAS DETALLADAS) ========= -->
        <h2 style="color:white; font-size:2.5rem; margin-top:50px;"><i class="fas fa-users"></i> Tus gu√≠as especiales</h2>
        <div class="characters-panel" id="characterPanel"></div>

        <!-- ========== DATOS CURIOSOS (ATRACTIVOS) ========= -->
        <h2 style="color:white; font-size:2.5rem;"><i class="fas fa-lightbulb"></i> Datos que sorprenden</h2>
        <div class="facts-cool" id="factsContainer"></div>

        <!-- ========== MEDALLERO ========= -->
        <div style="background:rgba(255,255,255,0.7); border-radius:50px; padding:20px; margin:30px 0;">
            <h2 style="color:#1e3c1e;"><i class="fas fa-medal"></i> Medallas especiales</h2>
            <div class="badge-collection" id="badgesEarned">
                <!-- JS genera medallas obtenidas -->
            </div>
        </div>

        <!-- ========== RECURSO EDUCATIVO DIGITAL: GENIALLY (SIMULACI√ìN) ========= -->
        <div class="genially-modal">
            <div style="display:flex; align-items:center; gap:20px;">
                <span style="font-size:5rem;">üéÆ</span>
                <div>
                    <h2 style="color:#b3e5fc;">RECURSO EDUCATIVO DIGITAL ¬∑ GENIALLY</h2>
                    <p style="font-size:1.3rem; color:#e0f2fe;">‚ú® Hemos integrado un tablero interactivo en Genially que contiene:</p>
                    <ul style="font-size:1.2rem; color:white;">
                        <li><i class="fas fa-check-circle"></i> Ruleta de retos sorpresa.</li>
                        <li><i class="fas fa-check-circle"></i> √Årbol de progreso donde cada misi√≥n hace crecer una planta virtual.</li>
                        <li><i class="fas fa-check-circle"></i> Video del Zorro Sabio dando pistas personalizadas.</li>
                        <li><i class="fas fa-check-circle"></i> Enlace directo: <a href="#" style="color:#ffd600;">https://view.genial.ly/guardianes-planeta</a> (simulado)</li>
                    </ul>
                    <p style="background:#004d40; padding:10px; border-radius:20px;"><strong>¬øQu√© aporta?</strong> Permite visualizar el progreso grupal, canciones ecol√≥gicas y una aventura interactiva que complementa las misiones f√≠sicas.</p>
                </div>
            </div>
        </div>

        <!-- ========== CERTIFICADO DESCARGABLE ========= -->
        <div id="certificateContainer" style="display:none;">
            <div id="certificateDesign" style="background:white; padding:40px; border:20px solid #4caf50; border-radius:60px; text-align:center; font-family:'Poppins';">
                <h1 style="color:#2e7d32;">üåç CERTIFICADO GUARDI√ÅN DEL PLANETA</h1>
                <p style="font-size:2rem;">Otorgado a:</p>
                <p style="font-size:3rem; font-weight:900; border-bottom:5px solid #ffb300;" id="studentNameCertificate">Guardi√°n</p>
                <p style="font-size:1.5rem;">Por completar las 5 misiones y demostrar amor por la Tierra.</p>
                <p>‚≠ê Capitana Verde ¬∑ Mago del Reciclaje ¬∑ Zorro Sabio ‚≠ê</p>
                <p style="margin-top:30px;">Fecha: <span id="dateCertificate"></span></p>
            </div>
        </div>
        <div class="certificate-area" id="certificateActionArea" style="display:none;">
            <button onclick="downloadCertificate()" style="background:#ffb300; padding:25px; font-size:2rem; border-radius:40px; border:none; cursor:pointer;"><i class="fas fa-download"></i> Descargar mi certificado de S√∫per Guardi√°n</button>
        </div>

        <!-- ========== JUSTIFICACI√ìN PEDAG√ìGICA (AUTORES + RELACI√ìN) ========= -->
        <div class="pedagogy-section">
            <h2 style="color:#1a237e;"><i class="fas fa-graduation-cap"></i> Justificaci√≥n pedag√≥gica: autores y dise√±o gamificado</h2>
            <div style="display:grid; gap:30px; grid-template-columns:1fr 1fr 1fr; margin-top:20px;">
                <div style="background:#c5cae9; padding:20px; border-radius:20px;">
                    <h3>üéÆ James Paul Gee</h3>
                    <p><strong>En nuestra propuesta:</strong> ‚ÄúAprendizaje situado y exploraci√≥n‚Äù. El ni√±o es un ‚Äúguardi√°n‚Äù que construye conocimiento al resolver misiones reales. Los personajes act√∫an como andamiaje (scaffolding).</p>
                </div>
                <div style="background:#b39ddb; padding:20px; border-radius:20px;">
                    <h3>‚öôÔ∏è Karl Kapp</h3>
                    <p><strong>En nuestra propuesta:</strong> ‚ÄúAlineaci√≥n juego-aprendizaje‚Äù. Cada misi√≥n tiene un objetivo pedag√≥gico claro (ahorrar agua, reciclar). La retroalimentaci√≥n inmediata (feedback en tarjetas) y puntos refuerzan la motivaci√≥n.</p>
                </div>
                <div style="background:#ffcc80; padding:20px; border-radius:20px;">
                    <h3>üå± Chamorro</h3>
                    <p><strong>En nuestra propuesta:</strong> ‚ÄúEstudiante activo‚Äù. No solo premiamos, sino que desarrollan autonom√≠a al decidir c√≥mo cumplir la misi√≥n y cooperaci√≥n al involucrar a la familia. Los niveles no son solo competencia, sino dominio de h√°bitos.</p>
                </div>
            </div>
            <p style="margin-top:30px; font-size:1.2rem;"><strong>Referencias completas:</strong> Gee, J. P. (2004). Lo que nos ense√±an los videojuegos sobre el aprendizaje y el alfabetismo. Kapp, K. (2012). The Gamification of Learning and Instruction. Chamorro, D. (2018). Gamificaci√≥n en Educaci√≥n Infantil. </p>
        </div>
    </div>

    <script>
        // ---------- ESTADO GLOBAL DEL JUEGO ----------
        let gameState = {
            level: 1,
            points: 0,
            completedMissions: [],
            badges: []
        };

        // Cargar del localStorage
        if (localStorage.getItem('guardianesGameV2')) {
            gameState = JSON.parse(localStorage.getItem('guardianesGameV2'));
        } else {
            // estado inicial
            gameState = { level: 1, points: 0, completedMissions: [], badges: [] };
        }

        // ---------- BASE DE DATOS DE MISIONES (con pistas y feedback) ----------
        const missionsData = [
            { id: 1, emoji: 'üíß', title: 'Cuidar el Agua', levelReq: 1, points: 100, description: 'Cerrar el grifo mientras te cepillas.', pista: 'El Zorro Sabio dice: usa un vaso con agua para enjuagar. ¬°Ahorras 12 vasos!', feedback: '¬°S√∫per! Cada gota cuenta. Dile a tu familia lo importante que es cerrar la llave.' },
            { id: 2, emoji: '‚ôªÔ∏è', title: 'Reciclar', levelReq: 1, points: 150, description: 'Separar papel, pl√°stico y vidrio.', pista: 'Mago del Reciclaje: el azul es papel, amarillo pl√°stico, verde vidrio.', feedback: '¬°Eres un campe√≥n del reciclaje! Ayudaste a que los materiales vuelvan a nacer.' },
            { id: 3, emoji: 'üå±', title: 'Plantar una Planta', levelReq: 2, points: 250, description: 'Siembra una semilla y cu√≠dala.', pista: 'Capitana Verde: una semilla de frijol en algod√≥n crece r√°pido. ¬°No olvides regarla!', feedback: '¬°Tu planta limpiar√° el aire! Eres amigo de los √°rboles.' },
            { id: 4, emoji: 'üö∂', title: 'Caminar m√°s', levelReq: 2, points: 350, description: 'Ve caminando a sitios cercanos.', pista: 'Zorro Sabio: caminar fortalece tu coraz√≥n y no contamina.', feedback: '¬°Pies felices, planeta feliz! Evitaste humo de autos.' },
            { id: 5, emoji: 'üé®', title: 'Arte Reciclado', levelReq: 3, points: 500, description: 'Crea algo con materiales usados.', pista: 'El Mago dice: una botella puede ser florero, un cart√≥n un robot.', feedback: '¬°Obra maestra! Diste nueva vida a los objetos.' }
        ];

        // Personajes con habilidades
        const characters = [
            { avatar: 'ü¶∏‚Äç‚ôÄÔ∏è', name: 'Capitana Verde', role: 'Superh√©roe de la naturaleza', power: 'üåø Hacer crecer plantas y purificar agua.', ayuda: 'Te reta a plantar y cuidar tu entorno.' },
            { avatar: 'üßô‚Äç‚ôÇÔ∏è', name: 'Mago del Reciclaje', role: 'Guardi√°n de los materiales', power: '‚ôªÔ∏è Transforma basura en juguetes.', ayuda: 'Te ense√±a a separar residuos y crear arte.' },
            { avatar: 'ü¶ä', name: 'Zorro Sabio', role: 'Protector del bosque', power: 'üìö Habla con animales y sabe datos curiosos.', ayuda: 'Te da pistas y te cuenta secretos de la naturaleza.' }
        ];

        // Datos curiosos
        const facts = [
            { icon: 'üíß', title: 'Agua m√°gica', text: 'Cerrar el grifo ahorra 12 vasos de agua. ¬°Suficiente para tu mascota!' },
            { icon: 'üå≥', title: '√Årboles h√©roes', text: 'Un √°rbol da aire limpio a 2 personas todo un a√±o.' },
            { icon: 'üêù', title: 'Abejas viajeras', text: 'Sin ellas no habr√≠a manzanas ni fresas.' },
            { icon: '‚ôªÔ∏è', title: 'Energ√≠a reciclada', text: '1 botella reciclada = 3 horas de luz.' }
        ];

        // Medallas y condiciones
        function evaluateBadges() {
            let badges = [];
            if (gameState.completedMissions.includes(1)) badges.push({icon:'üíß', name:'Guardi√°n del Agua'});
            if (gameState.completedMissions.includes(2)) badges.push({icon:'‚ôªÔ∏è', name:'Rey del Reciclaje'});
            if (gameState.completedMissions.includes(3)) badges.push({icon:'üå≥', name:'Amigo de los √Årboles'});
            if (gameState.completedMissions.includes(4)) badges.push({icon:'üö∂', name:'Caminante Verde'});
            if (gameState.completedMissions.includes(5)) badges.push({icon:'üèÖ', name:'S√∫per H√©roe Verde'});
            if (gameState.completedMissions.length >= 3) badges.push({icon:'ü¶ä', name:'Amigo del Zorro'});
            return badges;
        }

        // Renderizar misiones con FEEDBACK y pistas
        function renderMissions() {
            let html = '';
            missionsData.forEach(m => {
                const completed = gameState.completedMissions.includes(m.id);
                const locked = gameState.level < m.levelReq && !completed;
                let feedbackMsg = completed ? '‚úÖ Completada: ' + m.feedback : (locked ? 'üîí Completa misiones anteriores.' : m.pista);
                html += `<div class="mission-card ${completed ? 'completed' : ''}">
                    <div class="mission-header">
                        <div class="mission-emoji">${m.emoji}</div>
                        <div class="mission-title">${m.title}</div>
                        <span class="mission-points">+${m.points} pts</span>
                    </div>
                    <div class="mission-body">
                        <p><strong>üß© Misi√≥n:</strong> ${m.description}</p>
                        <div class="feedback-area"><i class="fas fa-comment-dots"></i> ${feedbackMsg}</div>
                        <button class="btn-mission" onclick="completeMission(${m.id})" ${completed || locked ? 'disabled' : ''}>
                            ${completed ? '¬°H√©roe!' : locked ? 'Bloqueada' : '¬°Cumplir misi√≥n!'}
                        </button>
                    </div>
                </div>`;
            });
            document.getElementById('missionsContainer').innerHTML = html;
        }

        // Completar misi√≥n
        window.completeMission = function(id) {
            const mission = missionsData.find(m => m.id === id);
            if (!mission) return;
            if (gameState.completedMissions.includes(id)) { alert('Ya salvaste esta misi√≥n. ¬°Gracias!'); return; }
            if (gameState.level < mission.levelReq) { alert('üîí El Zorro Sabio dice: sube de nivel completando antes otras misiones.'); return; }
            
            // Agregar misi√≥n
            gameState.completedMissions.push(id);
            gameState.points += mission.points;
            
            // Calcular nivel
            if (gameState.completedMissions.length >= 4) gameState.level = 3;
            else if (gameState.completedMissions.length >= 2) gameState.level = 2;
            
            // Actualizar medallas
            gameState.badges = evaluateBadges();
            saveGame();
            updateUI();
            
            // Feedback especial con personaje
            let personaje = '';
            if (id === 1) personaje = 'üíß Capitana Verde';
            else if (id === 2) personaje = '‚ôªÔ∏è Mago del Reciclaje';
            else personaje = 'ü¶ä Zorro Sabio';
            alert(`üåü ${personaje}: ${mission.feedback} ¬°Has ganado ${mission.points} puntos!`);
            
            // Verificar si complet√≥ todas
            if (gameState.completedMissions.length === 5) {
                document.getElementById('certificateActionArea').style.display = 'block';
                document.getElementById('studentNameCertificate').innerText = 'Guardi√°n ' + localStorage.getItem('guardianName') || 'Estrella Verde';
                document.getElementById('dateCertificate').innerText = new Date().toLocaleDateString();
            }
        };

        // Render personajes (fichas)
        function renderCharacters() {
            let chHtml = '';
            characters.forEach(c => {
                chHtml += `<div class="character-pro">
                    <div class="character-avatar">${c.avatar}</div>
                    <div class="character-data">
                        <div class="character-name">${c.name}</div>
                        <div style="font-size:1.2rem; background:#e0e0e0; padding:5px; border-radius:20px;">${c.role}</div>
                        <div class="power-badge"><i class="fas fa-bolt"></i> ${c.power}</div>
                        <p><i class="fas fa-heart" style="color:red;"></i> ${c.ayuda}</p>
                    </div>
                </div>`;
            });
            document.getElementById('characterPanel').innerHTML = chHtml;
        }

        // Datos curiosos
        function renderFacts() {
            let fHtml = '';
            facts.forEach(f => {
                fHtml += `<div class="fact-item">
                    <span style="font-size:4rem;">${f.icon}</span>
                    <h3>${f.title}</h3>
                    <p style="font-size:1.3rem;">${f.text}</p>
                </div>`;
            });
            document.getElementById('factsContainer').innerHTML = fHtml;
        }

        // Medallas
        function renderBadges() {
            let badges = evaluateBadges();
            let bHtml = '';
            badges.forEach(b => {
                bHtml += `<div class="badge"><span style="font-size:3rem;">${b.icon}</span><br>${b.name}</div>`;
            });
            if (bHtml === '') bHtml = '<p style="padding:20px;">Completa misiones para ganar medallas üåü</p>';
            document.getElementById('badgesEarned').innerHTML = bHtml;
        }

        // Actualizar tablero
        function updateUI() {
            document.getElementById('levelDisplay').innerText = gameState.level;
            document.getElementById('pointsDisplay').innerText = gameState.points;
            document.getElementById('missionsCompleted').innerText = gameState.completedMissions.length;
            let next = (gameState.level === 1) ? 2 : (gameState.level === 2) ? 3 : 3;
            document.getElementById('nextLevelHint').innerText = (gameState.level === 3) ? 'M√°ximo' : next;
            renderMissions();
            renderBadges();
        }

        // Guardar
        function saveGame() {
            localStorage.setItem('guardianesGameV2', JSON.stringify(gameState));
        }

        // Certificado descargable
        window.downloadCertificate = function() {
            html2canvas(document.getElementById('certificateDesign')).then(canvas => {
                let link = document.createElement('a');
                link.download = 'certificado-guardian.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        };

        // Pedir nombre al inicio (para personalizar)
        (function init() {
            if (!localStorage.getItem('guardianName')) {
                let name = prompt('¬°Bienvenido, Guardi√°n! ¬øC√≥mo te llamas?', 'Guardi√°n');
                localStorage.setItem('guardianName', name || 'Guardi√°n');
            }
            renderCharacters();
            renderFacts();
            updateUI();
        })();

        // Reset opcional (escondido pero accesible)
        window.resetProgress = function() {
            if (confirm('¬øReiniciar progreso?')) {
                localStorage.removeItem('guardianesGameV2');
                location.reload();
            }
        };
    </script>
    <!-- Bot√≥n reset (oculto decorativo) -->
    <div style="text-align:center; margin-top:20px; color:white;">
        <button onclick="resetProgress()" style="background:#b71c1c; color:white; padding:10px 20px; border-radius:30px;">‚Üª Reiniciar progreso</button>
    </div>
</body>
</html>
